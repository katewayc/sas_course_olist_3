# SAS 程式流程解釋

**`PROC GLM`** 是 SAS 中最強大、最常用的程序之一。讓我們從理論概念開始，再進到程式碼逐行解析。

---

### 1. 什麼是 GLM 程序？

**GLM** 全名是 **General Linear Model（一般線性模型）**。

在統計學中，當我們要探討「X (自變項) 如何影響 Y (依變項)」時，會用到它。

* **如果不分組，X 是連續數字**：我們通常稱為「迴歸分析 (Regression)」。
* **如果 X 是分類標籤 (如：信用卡/現金)**：我們通常稱為「變異數分析 (ANOVA)」。

**為什麼要用 `PROC GLM`？**
因為你的任務三題目是：「**類別變項 (X)** 對 **連續變項 (Y)** 的影響」。
例如：不同「付款方式 (類別)」的客單價「金額 (連續)」是否不同？`PROC GLM` 專門處理這種**「比較多組平均數差異」**的工作。

---

### 2. 程式碼逐行解釋

我們拿剛剛分析「付款方式」的這段程式碼來拆解：

```sas
proc glm data=final_data;
    class payment_type;
    model payment_value = payment_type;
    means payment_type / lines;
run;

```

#### 第一行：呼叫程序

```sas
proc glm data=final_data;

```

* **翻譯**：「嘿 SAS，我要開始跑 **一般線性模型 (GLM)** 分析了，請使用 `final_data` 這張資料表。」
* **開發者視角**：這就像是呼叫一個 Function 或 API，`data=` 是傳入的參數。

#### 第二行：定義分類變項 (非常重要！)

```sas
class payment_type;

```

* **翻譯**：「`payment_type` (付款方式) 這個欄位是拿來**分組**用的，它不是數字，是標籤。」
* **詳細解釋**：
* 如果你不加這行，SAS 會以為 `payment_type` 是連續數字（像身高體重），然後跑成迴歸分析，結果就會全錯。
* 加上 `CLASS`，SAS 就知道要把資料切成「信用卡組」、「現金組」、「折價券組」來比較。



#### 第三行：建立模型公式 (核心靈魂)

```sas
model payment_value = payment_type;

```

* **翻譯**：「請幫我計算：**付款金額 (Y)** 是否受到 **付款方式 (X)** 的影響？」
* **數學意義**：這是寫方程式 。
* **等號左邊**：依變項 (Dependent Variable)，你要預測/分析的結果（錢）。
* **等號右邊**：自變項 (Independent Variable)，影響結果的原因（方式）。



#### 第四行：事後檢定 (Post-hoc Test)

```sas
means payment_type / lines;

```

* **翻譯**：「算出結果後，請幫我列出每一種付款方式的**平均金額 (Means)**，並且畫出**比較線圖 (Lines)**。」
* **為什麼需要這行？**
* `model` 語句只會告訴你「這幾組之間**有**差別」，但不會告訴你「**誰比誰大**」。
* `means` 會算出：信用卡平均刷 $163、折價券平均刷 $65。
* `/ lines` 是一個很棒的參數，它會在結果中用字母 (A, B, C...) 標記。標記不同字母代表差異顯著（例如信用卡是 A，折價券是 B，代表信用卡顯著大於折價券）。



#### 第五行：執行

```sas
run;

```

* **翻譯**：「設定結束，開始跑吧！」

---

### 3. 如何看分析結果？ (Quick Guide)

當你跑出報表時，只要看這三個重點：

1. **Pr > F (P-value)**：
* 如果在 `0.05` 以下 (例如 `<.0001`)，代表**「顯著相關」**。
* 白話文：付款方式**真的會影響**消費金額，這不是巧合。


2. **R-Square (R平方)**：
* 解釋力。代表你的 X 能解釋多少 Y 的變化。通常在社會科學或行銷資料中，0.1~0.3 都算正常。


3. **Means 報表中的 "t Grouping"**：
* 如果 **Credit Card** 旁邊寫 **"A"**，而 **Voucher** 旁邊寫 **"B"**。
* 結論就是：**使用信用卡的平均消費金額，顯著高於使用折價券的金額。**
